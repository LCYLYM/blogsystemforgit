<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="{{ blogBase['nightTheme'] }}" data-light-theme="{{ blogBase['dayTheme'] }}" lang={% if blogBase['i18n']=='CN' %}"zh-CN"{% elif blogBase['i18n']=='RU' %}"ru"{% else -%}"en"{%- endif -%}>
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    {{ blogBase['primerCSS'] }}
    {{ blogBase['allHead'] }}
    <link rel="icon" href="{{ blogBase['faviconUrl'] }}">
    {%- if blogBase['themeMode']=='manual' -%}
    <script>
        let theme = localStorage.getItem("meek_theme") || "light";
        document.documentElement.setAttribute("data-color-mode", theme);
    </script>
    {%- endif -%}
    {% block head %}{% endblock %}
</head>
<style>
body{box-sizing: border-box;min-width: 200px;max-width: 900px;margin: 20px auto;padding: 45px;font-size: 16px;font-family: sans-serif;line-height: 1.25;}
#header{display:flex;padding-bottom:8px;border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));margin-bottom: 16px;}
#footer {margin-top:64px; text-align: center;font-size: small;}

/* =====================
   “注视鼠标”左侧插画
   ===================== */
#gazeBuddy{
    position: fixed;
    left: 18px;
    bottom: 18px;
    width: 176px;
    height: 176px;
    z-index: 999;
    pointer-events: none;
    opacity: 0.95;
    filter: drop-shadow(0 8px 20px rgba(0,0,0,.18));
}
#gazeBuddy .gb-card{
    width: 100%;
    height: 100%;
    border-radius: 16px;
    background: var(--color-canvas-default);
    border: 1px solid var(--borderColor-muted, var(--color-border-muted));
}
#gazeBuddy svg{display:block; width:100%; height:100%;}

@media (max-width: 900px){
    #gazeBuddy{display:none;}
}
</style>
{% block style %}{% endblock %}

<body>
    <div id="gazeBuddy" aria-hidden="true">
        <div class="gb-card">
            <svg viewBox="0 0 176 176" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="gbBg" x1="0" y1="0" x2="1" y2="1">
                        <stop offset="0" stop-color="var(--color-canvas-subtle)"/>
                        <stop offset="1" stop-color="var(--color-canvas-default)"/>
                    </linearGradient>
                </defs>

                <rect x="0" y="0" width="176" height="176" rx="16" fill="url(#gbBg)"/>

                <circle cx="88" cy="92" r="52" fill="var(--color-canvas-inset)" stroke="var(--borderColor-muted, var(--color-border-muted))"/>
                <path d="M58 78c10-10 20-14 30-14s20 4 30 14" fill="none" stroke="var(--color-fg-muted)" stroke-width="4" stroke-linecap="round"/>

                <g id="gbEyes">
                    <g id="gbEyeL" transform="translate(62 92)">
                        <ellipse cx="0" cy="0" rx="16" ry="12" fill="var(--color-canvas-default)" stroke="var(--borderColor-muted, var(--color-border-muted))"/>
                        <circle id="gbPupilL" cx="0" cy="0" r="5" fill="var(--color-fg-default)"/>
                    </g>
                    <g id="gbEyeR" transform="translate(114 92)">
                        <ellipse cx="0" cy="0" rx="16" ry="12" fill="var(--color-canvas-default)" stroke="var(--borderColor-muted, var(--color-border-muted))"/>
                        <circle id="gbPupilR" cx="0" cy="0" r="5" fill="var(--color-fg-default)"/>
                    </g>
                </g>

                <path d="M72 122c8 8 24 8 32 0" fill="none" stroke="var(--color-fg-default)" stroke-width="4" stroke-linecap="round"/>
                <text x="88" y="160" text-anchor="middle" font-size="12" fill="var(--color-fg-muted)">Look at you.</text>
            </svg>
        </div>
    </div>

    <div id="header">{% block header %}{% endblock %}</div>
    <div id="content">{% block content %}{% endblock %}</div>
    <div id="footer">{% include 'footer.html' %}</div>
</body>
<script>
var IconList={{ IconList }};
var utterancesLoad=0;
{% if blogBase['themeMode']=='manual' %}
let themeSettings={
    "dark": ["dark","moon","#00f0ff","dark-blue"],
    "light": ["light","sun","#ff5000","github-light"],
    "auto": ["auto","sync","","preferred-color-scheme"]
};
function changeTheme(mode, icon, color, utheme){
    document.documentElement.setAttribute("data-color-mode",mode);
    document.getElementById("themeSwitch").setAttribute("d",value=IconList[icon]);
    document.getElementById("themeSwitch").parentNode.style.color=color;
    if(utterancesLoad==1){utterancesTheme(utheme);}
}
function modeSwitch(){
    let currentMode=document.documentElement.getAttribute('data-color-mode');
    let newMode = currentMode === "light" ? "dark" : currentMode === "dark" ? "auto" : "light";
    localStorage.setItem("meek_theme", newMode);
    if(themeSettings[newMode]){
        changeTheme(...themeSettings[newMode]);
    }
}
function utterancesTheme(theme){
    const message={type:'set-theme',theme: theme};
    const iframe=document.getElementsByClassName('utterances-frame')[0];
    iframe.contentWindow.postMessage(message,'https://utteranc.es');
}
if(themeSettings[theme]){changeTheme(...themeSettings[theme]);}
{%- endif %}

/* =====================
   鼠标注视逻辑：移动瞳孔
   ===================== */
(function(){
    const eyeL = document.getElementById('gbEyeL');
    const eyeR = document.getElementById('gbEyeR');
    const pupilL = document.getElementById('gbPupilL');
    const pupilR = document.getElementById('gbPupilR');

    if(!eyeL || !eyeR || !pupilL || !pupilR) return;

    function clamp(v, min, max){
        return Math.max(min, Math.min(max, v));
    }

    function setPupil(pupil, eyeEl, clientX, clientY){
        const rect = eyeEl.getBoundingClientRect();
        const cx = rect.left + rect.width / 2;
        const cy = rect.top + rect.height / 2;

        const dx = clientX - cx;
        const dy = clientY - cy;
        const dist = Math.sqrt(dx*dx + dy*dy) || 1;

        const maxOffset = 6;
        const ox = clamp(dx / dist, -1, 1) * maxOffset;
        const oy = clamp(dy / dist, -1, 1) * maxOffset;

        pupil.setAttribute('cx', ox.toFixed(2));
        pupil.setAttribute('cy', oy.toFixed(2));
    }

    window.addEventListener('mousemove', (e) => {
        setPupil(pupilL, eyeL, e.clientX, e.clientY);
        setPupil(pupilR, eyeR, e.clientX, e.clientY);
    }, {passive:true});
})();

console.log("\n %c Gmeek {{ blogBase['GMEEK_VERSION'] }} https://github.com/Meekdai/Gmeek \n","padding:5px 0;background:#02d81d;color:#fff");
</script>
{% block script %}{% endblock %}
</html>
