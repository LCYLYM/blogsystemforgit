<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="{{ blogBase['nightTheme'] }}" data-light-theme="{{ blogBase['dayTheme'] }}" lang={% if blogBase['i18n']=='CN' %}"zh-CN"{% elif blogBase['i18n']=='RU' %}"ru"{% else -%}"en"{%- endif -%}>
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tailwind UI (from blogui.md) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&family=Cinzel:wght@400;700;900&family=Inter:wght@300;400;600&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>

    <!-- Keep Primer for markdown-body rendering (post content) -->
    {{ blogBase['primerCSS'] }}
    {{ blogBase['allHead'] }}
    <link rel="icon" href="{{ blogBase['faviconUrl'] }}">
    {%- if blogBase['themeMode']=='manual' -%}
    <script>
        let theme = localStorage.getItem("meek_theme") || "light";
        document.documentElement.setAttribute("data-color-mode", theme);
    </script>
    {%- endif -%}
    {% block head %}{% endblock %}
</head>
<style>
/* === Core base (from blogui.md) === */
body {
    transition: background-color 0.8s cubic-bezier(0.22, 1, 0.36, 1), color 0.5s ease;
    overflow-x: hidden;
    min-height: 100vh;
    cursor: none;
}
::-webkit-scrollbar { width: 0px; }

.svg-filters { position: absolute; width: 0; height: 0; pointer-events: none; }

/* Cursor sprite */
#sprite-container {
    position: fixed;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 9999;
    will-change: transform;
}
.sprite-body {
    width: 20px;
    height: 20px;
    background: white;
    border-radius: 50%;
    box-shadow: 0 0 10px rgba(255,255,255,0.8), 0 0 20px var(--accent);
    transition: all 0.3s ease;
    position: relative;
}
.sprite-trail {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background: inherit;
    opacity: 0.5;
    transform: translate(-50%, -50%) scale(1.5);
    filter: blur(4px);
}

/* Themes */
.theme-ethereal {
    background: #0a0a12;
    color: #e2e8f0;
    font-family: 'Inter', sans-serif;
    --accent: #60a5fa;
    --card-bg: rgba(255, 255, 255, 0.02);
    --border: rgba(255, 255, 255, 0.08);
}
.theme-ethereal .bg-blob { display: block; opacity: 0.5; }

.theme-cyber {
    background: #050505;
    color: #00ff41;
    font-family: 'Space Mono', monospace;
    --accent: #ff00ff;
    --border: #008F11;
}
.theme-cyber::before {
    content: " ";
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%),
        linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
    z-index: 50;
    background-size: 100% 2px, 3px 100%;
    pointer-events: none;
}
body.theme-cyber #sprite-container .sprite-body {
    background: #0f0;
    border-radius: 0;
    width: 16px;
    height: 16px;
    box-shadow: 0 0 0 2px black, 0 0 0 4px #0f0;
    animation: sprite-glitch 0.2s infinite;
}
@keyframes sprite-glitch {
    0% { transform: translate(0,0); }
    20% { transform: translate(-2px, 2px); }
    40% { transform: translate(2px, -2px); }
    60% { transform: translate(-2px, -2px); }
    80% { transform: translate(2px, 2px); }
    100% { transform: translate(0,0); }
}

.theme-oil {
    background: #e6dace;
    color: #1a1a1a;
    font-family: 'Playfair Display', serif;
    --accent: #e07a5f;
    background-image: url("data:image/svg+xml,%3Csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.08'/%3E%3C/svg%3E");
}
body.theme-oil #sprite-container .sprite-body {
    background: #ffaa00;
    width: 30px;
    height: 30px;
    border-radius: 50% 50% 50% 0;
    transform: rotate(-45deg);
    box-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    filter: url(#oilFilterSmall);
}

/* Layout + cards */
.bg-blob {
    position: fixed;
    width: 600px;
    height: 600px;
    filter: blur(100px);
    z-index: -1;
    opacity: 0;
    border-radius: 50%;
    animation: float 15s infinite ease-in-out;
    transition: opacity 1s;
}
@keyframes float {
    0%, 100% { transform: translate(0, 0) scale(1); }
    33% { transform: translate(30px, -50px) scale(1.1); }
    66% { transform: translate(-20px, 20px) scale(0.9); }
}

.card {
    background: var(--card-bg, rgba(255,255,255,0.03));
    border: 1px solid var(--border, rgba(255,255,255,0.08));
    border-radius: 24px;
    overflow: hidden;
    transition: transform 0.6s cubic-bezier(0.16, 1, 0.3, 1), box-shadow 0.6s ease, border-color 0.6s ease;
}
.theme-ethereal .card:hover {
    transform: translateY(-8px) scale(1.01);
    box-shadow: 0 20px 40px -10px rgba(0,0,0,0.5);
    border-color: rgba(255,255,255,0.2);
}
.theme-cyber .card {
    background: #000;
    border: 1px solid var(--border);
    position: relative;
    clip-path: polygon(0 0, 100% 0, 100% calc(100% - 20px), calc(100% - 20px) 100%, 0 100%);
}
.theme-cyber .card:hover {
    box-shadow: -4px 4px 0 var(--accent);
    transform: translate(2px, -2px);
}
.theme-oil .card {
    background: #f4f1ea;
    box-shadow: 10px 10px 20px rgba(0,0,0,0.1), -5px -5px 15px rgba(255,255,255,0.8);
    border: 8px solid white;
    border-bottom-width: 24px;
    transform: rotate(0deg);
    transition: all 0.4s ease;
}
.theme-oil .card:nth-child(even) { transform: rotate(1deg); }
.theme-oil .card:nth-child(odd) { transform: rotate(-1deg); }
.theme-oil .card:hover {
    transform: rotate(0deg) scale(1.05);
    z-index: 10;
    box-shadow: 15px 15px 30px rgba(0,0,0,0.2);
}

@media (max-width: 640px){
    body{cursor:auto;}
    #sprite-container{display:none;}
}
</style>
{% block style %}{% endblock %}

<body class="theme-ethereal" id="app">
    <!-- SVG Filters Definition (Hidden) -->
    <svg class="svg-filters">
        <defs>
            <filter id="oilFilterSmall">
                <feTurbulence type="fractalNoise" baseFrequency="0.1" numOctaves="2" result="noise" />
                <feDisplacementMap in="SourceGraphic" in2="noise" scale="3" />
            </filter>
        </defs>
    </svg>

    <!-- Cursor sprite -->
    <div id="sprite-container" aria-hidden="true">
        <div class="sprite-body">
            <div class="sprite-trail"></div>
        </div>
    </div>

    <!-- Background blobs (ethereal) -->
    <div class="bg-blob bg-blue-600 top-[-20%] left-[-10%]"></div>
    <div class="bg-blob bg-purple-600 bottom-[-20%] right-[-10%]"></div>
    <div class="bg-blob bg-emerald-500 top-[40%] left-[30%] w-96 h-96 mix-blend-overlay"></div>

    <!-- Navbar (page-specific content injected) -->
    <nav class="fixed top-0 w-full z-40 px-8 py-6 flex justify-between items-center transition-all duration-500 backdrop-blur-sm" id="navbar">
        {% block header %}{% endblock %}
    </nav>

    <!-- Main content -->
    <main class="container mx-auto px-6 pt-32 pb-24 relative z-10" id="main">
        {% block content %}{% endblock %}
        <footer class="py-12 text-center opacity-40 text-xs">
            {% include 'footer.html' %}
        </footer>
    </main>
</body>
<script>
var IconList={{ IconList }};
var utterancesLoad=0;
{% if blogBase['themeMode']=='manual' %}
let themeSettings={
    "dark": ["dark","moon","#00f0ff","dark-blue"],
    "light": ["light","sun","#ff5000","github-light"],
    "auto": ["auto","sync","","preferred-color-scheme"]
};
function changeTheme(mode, icon, color, utheme){
    document.documentElement.setAttribute("data-color-mode",mode);
    document.getElementById("themeSwitch").setAttribute("d",value=IconList[icon]);
    document.getElementById("themeSwitch").parentNode.style.color=color;
    if(utterancesLoad==1){utterancesTheme(utheme);}
}
function modeSwitch(){
    let currentMode=document.documentElement.getAttribute('data-color-mode');
    let newMode = currentMode === "light" ? "dark" : currentMode === "dark" ? "auto" : "light";
    localStorage.setItem("meek_theme", newMode);
    if(themeSettings[newMode]){
        changeTheme(...themeSettings[newMode]);
    }
}
function utterancesTheme(theme){
    const message={type:'set-theme',theme: theme};
    const iframe=document.getElementsByClassName('utterances-frame')[0];
    iframe.contentWindow.postMessage(message,'https://utteranc.es');
}
if(themeSettings[theme]){changeTheme(...themeSettings[theme]);}
{%- endif %}

// =========================
// blogui.md Theme + Sprite
// =========================
(function(){
    // Theme
    const body = document.getElementById('app');
    const THEME_KEY = 'pd_theme';
    const themes = {
        ethereal: {
            logo: 'VOID.',
            title: 'BEYOND<br>REALITY',
            desc: '探索数字边界之外的存在。当代码凝固成艺术，当逻辑在油彩中溶解。'
        },
        cyber: {
            logo: '>_ROOT',
            title: 'SYSTEM<br>OVERRIDE',
            desc: 'DETECTED UNAUTHORIZED ACCESS. REALITY PROTOCOL CORRUPTED. INITIALIZING...'
        },
        oil: {
            logo: 'MUSEUM.',
            title: 'STARRY<br>DREAMS',
            desc: '生活不仅是眼前的苟且，还有诗和远方。在这里，每一行代码都是画布上的笔触。'
        }
    };

    function applyTheme(themeName){
        if(!body) return;
        body.className = `theme-${themeName}`;
        localStorage.setItem(THEME_KEY, themeName);

        const config = themes[themeName];
        if(!config) return;

        const logo = document.getElementById('logo-text');
        const title = document.getElementById('hero-title');
        const desc = document.getElementById('hero-desc');

        // Only exists on index
        if(logo) logo.innerHTML = config.logo;
        if(title) title.innerHTML = config.title;
        if(desc) desc.innerHTML = config.desc;
    }

    window.setTheme = applyTheme;
    const saved = localStorage.getItem(THEME_KEY) || 'ethereal';
    applyTheme(saved);

    // Lucide
    if(window.lucide && typeof window.lucide.createIcons === 'function'){
        window.lucide.createIcons();
    }

    // Sprite physics
    const sprite = document.getElementById('sprite-container');
    if(!sprite) return;

    let mouseX = window.innerWidth / 2;
    let mouseY = window.innerHeight / 2;
    let spriteX = mouseX;
    let spriteY = mouseY;
    let velX = 0;
    let velY = 0;
    const drag = 0.15;
    const spring = 0.1;

    document.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
    }, {passive:true});

    function animateSprite(){
        const dx = mouseX - spriteX;
        const dy = mouseY - spriteY;

        velX += dx * spring;
        velY += dy * spring;

        velX *= (1 - drag);
        velY *= (1 - drag);

        spriteX += velX;
        spriteY += velY;

        const speed = Math.sqrt(velX*velX + velY*velY);
        const angle = Math.atan2(velY, velX) * 180 / Math.PI;
        const stretch = Math.min(1 + speed / 50, 1.5);
        const squash = 1 / stretch;

        sprite.style.transform = `translate(${spriteX}px, ${spriteY}px) translate(-50%, -50%) rotate(${angle}deg) scale(${stretch}, ${squash})`;
        requestAnimationFrame(animateSprite);
    }
    animateSprite();

    // Hover reactions
    function setSpriteActive(active){
        const bodyEl = sprite.querySelector('.sprite-body');
        if(!bodyEl) return;
        if(active){
            bodyEl.style.transform = 'scale(1.5)';
            bodyEl.style.background = 'var(--accent)';
        }else{
            bodyEl.style.transform = 'scale(1)';
            bodyEl.style.background = '';
        }
    }
    document.addEventListener('mouseover', (e) => {
        const t = e.target;
        if(!t) return;
        if(t.closest && t.closest('a, button, .card')) setSpriteActive(true);
    });
    document.addEventListener('mouseout', (e) => {
        const t = e.target;
        if(!t) return;
        if(t.closest && t.closest('a, button, .card')) setSpriteActive(false);
    });
})();

console.log("\n %c Gmeek {{ blogBase['GMEEK_VERSION'] }} https://github.com/Meekdai/Gmeek \n","padding:5px 0;background:#02d81d;color:#fff");
</script>
{% block script %}{% endblock %}
</html>
